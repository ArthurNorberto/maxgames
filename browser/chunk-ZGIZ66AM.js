import{a as L}from"./chunk-2MTX3D2T.js";import{h as j}from"./chunk-TY3XJY7P.js";import"./chunk-5BLSFZMB.js";import{b as W,d as N,g as H,t as R}from"./chunk-5VMU7HGZ.js";import{Ab as h,Bb as g,Db as S,Ea as y,Eb as Q,Fb as P,Ga as o,Jb as w,Pa as x,T as p,U as f,Ua as E,Ya as _,db as c,dc as T,eb as r,ec as I,fb as t,fc as F,gb as O,lc as V,mb as b,ob as d,qb as u,sb as k,tb as M,ub as D,wb as A,xb as C,zb as n}from"./chunk-D5XL275M.js";var U=["answerInput"],q=()=>[];function $(l,i){l&1&&(r(0,"span",35),n(1,"\u2764\uFE0F"),t())}function G(l,i){l&1&&(r(0,"span",36),n(1,"\u2661"),t())}function z(l,i){if(l&1&&(r(0,"div",37)(1,"span",38),n(2),t()()),l&2){let e=u(2);o(2),g("\u{1F4A1} Resposta: ",e.revealedAnswer)}}function K(l,i){if(l&1){let e=b();r(0,"div",39)(1,"h5"),n(2,"Fim de jogo"),t(),r(3,"p"),n(4,"Pontua\xE7\xE3o final: "),r(5,"strong"),n(6),t()(),r(7,"button",40),d("click",function(){p(e);let s=u(2);return f(s.startDefault())}),n(8,"Jogar novamente"),t()()}if(l&2){let e=u(2);o(6),h(e.score)}}function J(l,i){if(l&1){let e=b();r(0,"div")(1,"div",15)(2,"div",16)(3,"div",17),n(4," Vidas: "),_(5,$,2,0,"span",18)(6,G,2,0,"span",19),t()(),r(7,"div",20)(8,"small",21),n(9,"Dica:"),t(),r(10,"div",22),n(11),t()(),r(12,"div",23)(13,"div",24),n(14),t()(),_(15,z,3,1,"div",25),r(16,"div",26)(17,"div",27)(18,"strong"),n(19),t()(),r(20,"div",28),O(21,"div",29),t()(),r(22,"div",30)(23,"input",31,0),P("ngModelChange",function(s){p(e);let m=u();return Q(m.answer,s)||(m.answer=s),f(s)}),d("keyup.enter",function(){p(e);let s=u();return f(s.submitAnswer())}),t(),r(25,"button",32),d("click",function(){p(e);let s=u();return f(s.submitAnswer())}),n(26,"Confirmar"),t(),r(27,"button",33),d("click",function(){p(e);let s=u();return f(s.giveUp())}),n(28,"Desistir"),t()()(),_(29,K,9,1,"div",34),t()}if(l&2){let e=u();o(5),c("ngForOf",w(15,q).constructor(e.lives)),o(),c("ngForOf",w(16,q).constructor(e.Math.max(0,5-e.lives))),o(5),h((e.currentQ==null?null:e.currentQ.pergunta)||"Clique em Iniciar para come\xE7ar"),o(),c("ngClass",e.msgClass),o(2),h(e.displayedMasked),o(),c("ngIf",e.revealedAnswer),o(4),g("",e.timeLeft,"s"),o(2),A("width",e.progressPercent,"%"),c("ngClass",e.timeColorClass),o(2),S("ngModel",e.answer),c("disabled",e.gameOver||!e.currentQ||e.inputDisabled),o(2),c("disabled",e.gameOver||!e.currentQ||e.inputDisabled),o(2),c("disabled",e.gameOver||!e.currentQ||e.inputDisabled),o(2),c("ngIf",e.gameOver)}}function Y(l,i){if(l&1){let e=b();r(0,"div",41)(1,"div",42)(2,"h5",43),n(3,"\u{1F4CA} Estat\xEDsticas"),t(),r(4,"div")(5,"strong"),n(6,"Acertos seguidos:"),t(),n(7),t(),r(8,"div")(9,"strong"),n(10,"Respondidas:"),t(),n(11),t(),r(12,"div")(13,"strong"),n(14,"Pontua\xE7\xE3o:"),t(),n(15),t(),r(16,"div",44)(17,"button",45),d("click",function(){p(e);let s=u();return f(s.startDefault())}),n(18,"\u{1F504} Reiniciar"),t()()()()}if(l&2){let e=u();o(7),g(" ",e.streak),o(4),g(" ",e.answeredCount),o(4),g(" ",e.score)}}var B=class l{constructor(i,e){this.toastr=i;this.gameService=e;this.questions=this.gameService.getAll()}answerInput;activeTab="jogo";difficulty="facil";Math=Math;lives=3;totalSeconds=30;timeLeft=this.totalSeconds;progressPercent=100;rafHandle=null;questions=[];filteredQuestions=[];currentIndex=-1;currentQ=null;revealedMask="";targetWord="";revealedAnswer=null;answer="";answeredCount=0;score=0;streak=0;gameOver=!1;msgClass="";inputDisabled=!1;ngAfterViewInit(){}ngOnDestroy(){this.clearTimers()}onKeyDown(i){i.key==="Enter"&&!this.gameOver&&!this.inputDisabled&&this.currentQ?this.submitAnswer():i.key==="Escape"&&!this.gameOver&&!this.inputDisabled&&this.giveUp()}startNewSession(){this.resetState(),this.filterQuestionsByDifficulty(),this.shuffleQuestions(),this.nextQuestion()}resetState(){this.clearTimers(),this.timeLeft=this.totalSeconds,this.progressPercent=100,this.answeredCount=0,this.score=0,this.streak=0,this.difficulty="facil",this.lives=3,this.gameOver=!1,this.currentIndex=-1,this.currentQ=null,this.answer="",this.revealedAnswer=null,this.inputDisabled=!1}shuffleQuestions(){for(let i=this.filteredQuestions.length-1;i>0;i--){let e=Math.floor(Math.random()*(i+1));[this.filteredQuestions[i],this.filteredQuestions[e]]=[this.filteredQuestions[e],this.filteredQuestions[i]]}}filterQuestionsByDifficulty(){let e={facil:"F\xE1cil",medio:"M\xE9dio",dificil:"Dif\xEDcil",muito:"Muito Dif\xEDcil",especialista:"Especialista"}[this.difficulty];this.filteredQuestions=this.questions.filter(a=>a.level===e)}nextQuestion(){this.clearTimers(),this.answer="",this.msgClass="",this.revealedAnswer=null,this.inputDisabled=!1,this.filteredQuestions.length===0&&(this.filterQuestionsByDifficulty(),this.shuffleQuestions()),this.currentIndex++,this.currentIndex>=this.filteredQuestions.length&&(this.currentIndex=0,this.shuffleQuestions()),this.currentQ=this.filteredQuestions[this.currentIndex],this.targetWord=this.currentQ.palavra.toUpperCase(),this.revealedMask=this.prepareMask(this.targetWord),this.timeLeft=this.totalSeconds,this.progressPercent=100,this.startTimer(),setTimeout(()=>this.answerInput?.nativeElement?.focus(),50)}prepareMask(i){let e=i.split(""),a=Math.min(2,Math.floor(i.length/3)),s=new Set;for(;s.size<a;)s.add(Math.floor(Math.random()*i.length));return e.map((m,v)=>s.has(v)?m:"_").join("")}submitAnswer(){if(!this.currentQ||this.gameOver||this.inputDisabled)return;let i=this.answer.trim().toUpperCase();i&&(this.inputDisabled=!0,this.clearTimers(),i===this.targetWord?this.onCorrect():this.onWrong())}onCorrect(){let e=this.getDifficultyMultiplier(this.difficulty),a=Math.max(.1,this.timeLeft/this.totalSeconds),s=Math.round(100*e*a+this.streak*5);this.score+=s,this.streak++,this.answeredCount++,this.revealedAnswer=this.currentQ?.palavra||null,this.revealedMask=this.targetWord,this.msgClass="pulse-correct",this.toastr.success(`Correto! +${s} pontos`,`N\xEDvel: ${this.currentQ?.level}`,{timeOut:1200}),this.updateDifficulty(),setTimeout(()=>this.nextQuestion(),2500)}onWrong(){this.lives--,this.streak=0,this.answeredCount++,this.revealedAnswer=this.currentQ?.palavra||null,this.revealedMask=this.targetWord,this.msgClass="shake-wrong",this.toastr.error(`Errado! Resposta: ${this.currentQ?.palavra}`,`N\xEDvel: ${this.currentQ?.level}`,{timeOut:1500}),this.lives<=0?setTimeout(()=>this.endGame(),2500):setTimeout(()=>this.nextQuestion(),2500)}giveUp(){!this.currentQ||this.gameOver||this.inputDisabled||(this.inputDisabled=!0,this.clearTimers(),this.lives--,this.streak=0,this.answeredCount++,this.revealedAnswer=this.currentQ.palavra,this.revealedMask=this.targetWord,this.msgClass="shake-wrong",this.toastr.info(`Desistiu \u2014 resposta: ${this.currentQ.palavra}`,`N\xEDvel: ${this.currentQ.level}`,{timeOut:1500}),this.lives<=0?setTimeout(()=>this.endGame(),2500):setTimeout(()=>this.nextQuestion(),2500))}updateDifficulty(){this.answeredCount>=40?this.difficulty="especialista":this.answeredCount>=30?this.difficulty="muito":this.answeredCount>=20?this.difficulty="dificil":this.answeredCount>=10?this.difficulty="medio":this.difficulty="facil",this.filterQuestionsByDifficulty(),this.shuffleQuestions(),this.currentIndex=-1}getDifficultyMultiplier(i){return{facil:.8,medio:1,dificil:1.3,muito:1.7,especialista:2.2}[i]}endGame(){this.clearTimers(),this.gameOver=!0,this.inputDisabled=!0,this.toastr.info(`Fim de jogo! Pontos: ${this.score}`,"Game Over")}startTimer(){this.clearTimers();let i=performance.now(),e=this.totalSeconds*1e3,a=s=>{let m=s-i,v=Math.max(0,e-m);if(this.timeLeft=Math.ceil(v/1e3),this.progressPercent=v/e*100,v<=0){this.inputDisabled=!0,this.onWrong();return}this.rafHandle=requestAnimationFrame(a)};this.rafHandle=requestAnimationFrame(a)}clearTimers(){this.rafHandle!==null&&(cancelAnimationFrame(this.rafHandle),this.rafHandle=null)}get timeColorClass(){return this.progressPercent>60?"bar-green":this.progressPercent>30?"bar-yellow":"bar-red blinking"}get displayedMasked(){return this.revealedMask.split("").join(" ")}startDefault(){this.startNewSession()}static \u0275fac=function(e){return new(e||l)(x(j),x(L))};static \u0275cmp=E({type:l,selectors:[["app-acerte-ou-erre"]],viewQuery:function(e,a){if(e&1&&k(U,5),e&2){let s;M(s=D())&&(a.answerInput=s.first)}},hostBindings:function(e,a){e&1&&d("keydown",function(m){return a.onKeyDown(m)},y)},decls:30,vars:8,consts:[["answerInput",""],[1,"aco-wrapper","container","py-4"],[1,"card","shadow-lg","border-0","game-card"],[1,"card-body","p-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"mb-1"],[1,"text-muted","small","mb-0"],[1,"d-flex","gap-2","align-items-center"],[1,"me-2","text-end","small"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"nav","nav-tabs","custom-tabs","mb-3"],[1,"nav-item"],[1,"nav-link",3,"click"],[4,"ngIf"],["class","rank-pane",4,"ngIf"],[1,"question-card","p-4","mb-3"],[1,"d-flex","justify-content-between","align-items-start","mb-2"],[1,"lives"],["class","life",4,"ngFor","ngForOf"],["class","life dead",4,"ngFor","ngForOf"],[1,"clue","mb-3"],[1,"text-muted"],[1,"clue-text"],[1,"masked-word","mb-3",3,"ngClass"],[1,"masked"],["class","revealed-answer text-center mb-3",4,"ngIf"],[1,"timer-row","mb-3"],[1,"time-left"],[1,"progress-wrapper","w-100","ms-3"],[1,"progress-bar",3,"ngClass"],[1,"answer-row","d-flex","gap-2","align-items-center"],["placeholder","Digite sua resposta...","autocomplete","off",1,"form-control","answer-input",3,"ngModelChange","keyup.enter","ngModel","disabled"],[1,"btn","btn-success",3,"click","disabled"],[1,"btn","btn-outline-danger",3,"click","disabled"],["class","mt-3 text-center",4,"ngIf"],[1,"life"],[1,"life","dead"],[1,"revealed-answer","text-center","mb-3"],[1,"badge","bg-success","px-3","py-2"],[1,"mt-3","text-center"],[1,"btn","btn-primary",3,"click"],[1,"rank-pane"],[1,"panel-stats","p-4","bg-light","rounded"],[1,"mb-3"],[1,"mt-4"],[1,"btn","btn-outline-primary","w-100",3,"click"]],template:function(e,a){e&1&&(r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div")(5,"h3",5),n(6,"\u{1F3AF} Acerte ou Erre \u2014 Autoglass"),t(),r(7,"p",6),n(8,"Responda r\xE1pido: 30s por pergunta. Menos erro = mais pontos!"),t()(),r(9,"div",7)(10,"div",8)(11,"div"),n(12,"Perguntas: "),r(13,"strong"),n(14),t()(),r(15,"div"),n(16,"Pontos: "),r(17,"strong"),n(18),t()()(),r(19,"button",9),d("click",function(){return a.startDefault()}),n(20,"\u25B6 Iniciar"),t()()(),r(21,"ul",10)(22,"li",11)(23,"button",12),d("click",function(){return a.activeTab="jogo"}),n(24," \u{1F3AE} Jogo "),t()(),r(25,"li",11)(26,"button",12),d("click",function(){return a.activeTab="rank"}),n(27," \u{1F3C6} Rank "),t()()(),_(28,J,30,17,"div",13)(29,Y,19,3,"div",14),t()()()),e&2&&(o(14),h(a.answeredCount),o(4),h(a.score),o(5),C("active",a.activeTab==="jogo"),o(3),C("active",a.activeTab==="rank"),o(2),c("ngIf",a.activeTab==="jogo"),o(),c("ngIf",a.activeTab==="rank"))},dependencies:[V,T,I,F,R,W,N,H],styles:["[_nghost-%COMP%]{display:block}.aco-wrapper[_ngcontent-%COMP%]{background:linear-gradient(180deg,#f7fbff,#eef6fb);min-height:100vh;padding:2rem 1rem;font-family:Segoe UI,system-ui}.aco-wrapper[_ngcontent-%COMP%]   .game-card[_ngcontent-%COMP%]{max-width:1000px;margin:auto;border-radius:12px}.custom-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{border:none;padding:10px 18px;font-weight:600;color:#004a7c;transition:.2s}.custom-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background:#004a7c;color:#fff;border-radius:8px}.question-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;border:1px solid rgba(0,0,0,.05);box-shadow:0 6px 18px #0000000f}.lives[_ngcontent-%COMP%]{font-weight:700;color:#06314a}.life[_ngcontent-%COMP%]{margin-left:6px;font-size:16px}.life.dead[_ngcontent-%COMP%]{opacity:.3}.clue-text[_ngcontent-%COMP%]{font-weight:600;color:#06314a}.masked-word[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.masked[_ngcontent-%COMP%]{background:#eef8ff;padding:12px 18px;border-radius:10px;font-size:1.6rem;letter-spacing:6px;border:2px solid rgba(0,0,0,.05)}.progress-wrapper[_ngcontent-%COMP%]{height:12px;border-radius:8px;background:#00000014}.progress-bar[_ngcontent-%COMP%]{height:100%;transition:width .12s linear}.progress-bar.bar-green[_ngcontent-%COMP%]{background:#23c275}.progress-bar.bar-yellow[_ngcontent-%COMP%]{background:#ffc84d}.progress-bar.bar-red[_ngcontent-%COMP%]{background:#ff6b6b}.rank-pane[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fade .4s ease}.panel-stats[_ngcontent-%COMP%]{border-radius:12px;background:#fff;border:1px solid rgba(0,0,0,.05);box-shadow:0 6px 18px #0000000f}@keyframes _ngcontent-%COMP%_fade{0%{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}"]})};export{B as AcerteOuErreComponent};
