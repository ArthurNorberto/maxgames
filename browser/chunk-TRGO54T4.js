import{a as B}from"./chunk-IW5BWOF2.js";import{b as W,c as u,d as I,e as O,g as N,h as k,i as T,j as A,k as G,l as D,m as V,n as L,s as R,t as j,u as q}from"./chunk-5VMU7HGZ.js";import{Ab as v,Db as P,Eb as y,Fb as w,Ga as o,Pa as C,T as h,U as b,Ua as S,Ya as f,a as p,db as m,eb as t,ec as x,fb as e,fc as M,gb as g,lc as F,mb as E,ob as d,qb as _,zb as n}from"./chunk-D5XL275M.js";function U(c,i){if(c&1){let r=E();t(0,"tr")(1,"td",51),n(2),e(),t(3,"td",51)(4,"span",52),n(5),e()(),t(6,"td",53)(7,"button",54),d("click",function(){let l=h(r).$implicit,s=_();return b(s.editarPalavra(s.allWords.indexOf(l)))}),n(8,"Editar"),e(),t(9,"button",55),d("click",function(){let l=h(r).$implicit,s=_();return b(s.removerPalavra(s.allWords.indexOf(l)))}),n(10,"Excluir"),e()()()}if(c&2){let r=i.$implicit;o(2),v(r.palavra),o(3),v(r.level)}}function $(c,i){c&1&&(t(0,"tr")(1,"td",56),n(2," Nenhuma palavra encontrada. "),e()())}function z(c,i){c&1&&(t(0,"div",57),n(1," Palavra inv\xE1lida (m\xEDn. 2 caracteres). "),e())}function H(c,i){if(c&1&&(t(0,"option",46),n(1),e()),c&2){let r=i.$implicit;m("ngValue",r),o(),v(r)}}var J=class c{constructor(i,r){this.fb=i;this.service=r;this.wordForm=this.fb.group({palavra:["",[u.required,u.minLength(2)]],level:["F\xE1cil",u.required]}),this.settingsForm=this.fb.group({minGrid:[this.defaultSettings.minGrid,[u.required,u.min(5)]],maxGrid:[this.defaultSettings.maxGrid,[u.required,u.min(6)]],allowDiagonals:[this.defaultSettings.allowDiagonals],allowReverse:[this.defaultSettings.allowReverse],maxPlacementAttempts:[this.defaultSettings.maxPlacementAttempts,[u.required,u.min(10)]],timeLimitSec:[this.defaultSettings.timeLimitSec],baseScorePerWord:[this.defaultSettings.baseScorePerWord,[u.required,u.min(1)]]})}allWords=[];filteredWords=[];filtro="";wordModalInstance;settingsModalInstance;wordForm;settingsForm;editingIndex=null;niveis=["F\xE1cil","M\xE9dio","Dif\xEDcil","Muito Dif\xEDcil","Especialista"];defaultSettings={minGrid:12,maxGrid:20,allowDiagonals:!0,allowReverse:!0,maxPlacementAttempts:200,timeLimitSec:null,baseScorePerWord:100};settings=p({},this.defaultSettings);ngOnInit(){if(this.service.getAllWords?this.allWords=this.service.getAllWords():this.service.getPalavras&&(this.allWords=this.service.getPalavras().map(i=>({palavra:i.toUpperCase(),level:"M\xE9dio"}))),this.filteredWords=[...this.allWords],this.service.getSettings){let i=this.service.getSettings();i&&(this.settings=p(p({},this.defaultSettings),i))}this.settingsForm.patchValue(this.settings),setTimeout(()=>{let i=document.getElementById("wordModal");i&&(this.wordModalInstance=new bootstrap.Modal(i));let r=document.getElementById("settingsModal");r&&(this.settingsModalInstance=new bootstrap.Modal(r))},50)}ngOnDestroy(){this.wordModalInstance?.hide(),this.settingsModalInstance?.hide()}aplicarFiltro(){let i=(this.filtro||"").trim().toLowerCase();if(!i){this.filteredWords=[...this.allWords];return}this.filteredWords=this.allWords.filter(r=>r.palavra.toLowerCase().includes(i))}novaPalavra(){this.editingIndex=null,this.wordForm.reset({palavra:"",level:"F\xE1cil"}),this.wordModalInstance?.show()}editarPalavra(i){this.editingIndex=i,this.wordForm.setValue(p({},this.allWords[i])),this.wordModalInstance?.show()}salvarPalavra(){if(this.wordForm.invalid){this.wordForm.markAllAsTouched();return}let i={palavra:this.wordForm.value.palavra.trim().toUpperCase(),level:this.wordForm.value.level};this.editingIndex!==null?(this.allWords[this.editingIndex]=i,this.service.updateWord&&this.service.updateWord(this.editingIndex,i)):(this.allWords.unshift(i),this.service.addWord&&this.service.addWord(i)),this.aplicarFiltro(),this.wordModalInstance?.hide()}removerPalavra(i){let r=this.allWords[i];confirm(`Excluir a palavra "${r.palavra}" ?`)&&(this.service.removeWord&&this.service.removeWord(i),this.allWords.splice(i,1),this.aplicarFiltro())}removerSelecionadas(){if(!confirm(`Excluir ${this.filteredWords.length} palavras filtradas?`))return;let i=new Set(this.filteredWords.map(r=>r.palavra));this.allWords=this.allWords.filter(r=>!i.has(r.palavra)),this.service.setAllWords&&this.service.setAllWords(this.allWords),this.aplicarFiltro()}abrirSettings(){this.settingsModalInstance?.show()}salvarSettings(){let i=this.settingsForm.value;this.settings=p(p({},this.settings),i),this.service.saveSettings&&this.service.saveSettings(this.settings),this.settingsModalInstance?.hide()}exportJson(){let i={words:this.allWords,settings:this.settings},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),a=URL.createObjectURL(r),l=document.createElement("a");l.href=a,l.download="caca-palavras-config.json",l.click(),URL.revokeObjectURL(a)}importJson(i){let r=i.target;if(!r.files?.length)return;let a=r.files[0],l=new FileReader;l.onload=()=>{try{let s=JSON.parse(String(l.result));Array.isArray(s.words)&&(this.allWords=s.words,this.service.setAllWords&&this.service.setAllWords(this.allWords)),s.settings&&(this.settings=p(p({},this.settings),s.settings),this.settingsForm.patchValue(this.settings),this.service.saveSettings&&this.service.saveSettings(this.settings)),this.aplicarFiltro(),alert("Importa\xE7\xE3o conclu\xEDda!")}catch{alert("Erro ao importar JSON")}},l.readAsText(a)}static \u0275fac=function(r){return new(r||c)(C(R),C(B))};static \u0275cmp=S({type:c,selectors:[["app-caca-palavras-config"]],decls:110,vars:13,consts:[[1,"admin-container","container","py-3"],[1,"d-flex","align-items-center","justify-content-between","mb-3"],[1,"page-title","mb-0"],[1,"text-muted"],[1,"d-flex","gap-2","align-items-center"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-plus-lg"],[1,"btn","btn-outline-secondary",3,"click"],[1,"bi","bi-gear"],[1,"btn-group"],[1,"btn","btn-outline-success",3,"click"],[1,"btn","btn-outline-info","mb-0"],["type","file","accept",".json","hidden","",3,"change"],[1,"mb-3","d-flex","gap-2"],["placeholder","Pesquisar palavra...",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-danger",3,"click","disabled"],[1,"table-responsive","card","p-0","shadow-sm"],[1,"table","mb-0"],[1,"table-light"],[2,"width","160px"],[2,"width","140px"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","wordModal","tabindex","-1","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content",3,"ngSubmit","formGroup"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mb-3"],[1,"form-label"],["formControlName","palavra","placeholder","Ex: PNEU",1,"form-control"],["class","text-danger small mt-1",4,"ngIf"],["formControlName","level",1,"form-select"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary"],["id","settingsModal","tabindex","-1","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"row","g-3"],[1,"col-md-6"],["type","number","formControlName","minGrid",1,"form-control"],["type","number","formControlName","maxGrid",1,"form-control"],["formControlName","allowDiagonals",1,"form-select"],[3,"ngValue"],["formControlName","allowReverse",1,"form-select"],["type","number","formControlName","maxPlacementAttempts",1,"form-control"],["type","number","formControlName","timeLimitSec",1,"form-control"],["type","number","formControlName","baseScorePerWord",1,"form-control"],[1,"align-middle"],[1,"badge","bg-secondary"],[1,"align-middle","text-end"],[1,"btn","btn-sm","btn-outline-primary","me-2",3,"click"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],["colspan","3",1,"text-center","py-4","text-muted"],[1,"text-danger","small","mt-1"]],template:function(r,a){if(r&1&&(t(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),n(4,"Ca\xE7a-Palavras \u2014 Administra\xE7\xE3o"),e(),t(5,"small",3),n(6,"Gerencie palavras, n\xEDveis e configura\xE7\xF5es do jogo"),e()(),t(7,"div",4)(8,"button",5),d("click",function(){return a.novaPalavra()}),g(9,"i",6),n(10," Nova palavra "),e(),t(11,"button",7),d("click",function(){return a.abrirSettings()}),g(12,"i",8),n(13," Configura\xE7\xF5es "),e(),t(14,"div",9)(15,"button",10),d("click",function(){return a.exportJson()}),n(16,"Exportar"),e(),t(17,"label",11),n(18," Importar "),t(19,"input",12),d("change",function(s){return a.importJson(s)}),e()()()()(),t(20,"div",13)(21,"input",14),w("ngModelChange",function(s){return y(a.filtro,s)||(a.filtro=s),s}),d("ngModelChange",function(){return a.aplicarFiltro()}),e(),t(22,"button",15),d("click",function(){return a.removerSelecionadas()}),n(23," Remover filtradas "),e()(),t(24,"div",16)(25,"table",17)(26,"thead",18)(27,"tr")(28,"th",19),n(29,"Palavra"),e(),t(30,"th",20),n(31,"N\xEDvel"),e(),t(32,"th",19),n(33,"A\xE7\xF5es"),e()()(),t(34,"tbody"),f(35,U,11,2,"tr",21)(36,$,3,0,"tr",22),e()()()(),t(37,"div",23)(38,"div",24)(39,"form",25),d("ngSubmit",function(){return a.salvarPalavra()}),t(40,"div",26)(41,"h5",27),n(42),e(),t(43,"button",28),d("click",function(){return a.wordModalInstance==null?null:a.wordModalInstance.hide()}),e()(),t(44,"div",29)(45,"div",30)(46,"label",31),n(47,"Palavra"),e(),g(48,"input",32),f(49,z,2,0,"div",33),e(),t(50,"div",30)(51,"label",31),n(52,"N\xEDvel"),e(),t(53,"select",34),f(54,H,2,2,"option",35),e()()(),t(55,"div",36)(56,"button",37),d("click",function(){return a.wordModalInstance==null?null:a.wordModalInstance.hide()}),n(57,"Cancelar"),e(),t(58,"button",38),n(59,"Salvar"),e()()()()(),t(60,"div",39)(61,"div",40)(62,"form",25),d("ngSubmit",function(){return a.salvarSettings()}),t(63,"div",26)(64,"h5",27),n(65,"Configura\xE7\xF5es do Ca\xE7a-Palavras"),e(),t(66,"button",28),d("click",function(){return a.settingsModalInstance==null?null:a.settingsModalInstance.hide()}),e()(),t(67,"div",29)(68,"div",41)(69,"div",42)(70,"label",31),n(71,"Grid m\xEDnimo"),e(),g(72,"input",43),e(),t(73,"div",42)(74,"label",31),n(75,"Grid m\xE1ximo"),e(),g(76,"input",44),e(),t(77,"div",42)(78,"label",31),n(79,"Permitir diagonais"),e(),t(80,"select",45)(81,"option",46),n(82,"Sim"),e(),t(83,"option",46),n(84,"N\xE3o"),e()()(),t(85,"div",42)(86,"label",31),n(87,"Permitir palavras ao contr\xE1rio"),e(),t(88,"select",47)(89,"option",46),n(90,"Sim"),e(),t(91,"option",46),n(92,"N\xE3o"),e()()(),t(93,"div",42)(94,"label",31),n(95,"Tentativas m\xE1x. para posicionar"),e(),g(96,"input",48),e(),t(97,"div",42)(98,"label",31),n(99,"Tempo limite (seg.) \u2014 vazio = sem limite"),e(),g(100,"input",49),e(),t(101,"div",42)(102,"label",31),n(103,"Pontua\xE7\xE3o base por palavra"),e(),g(104,"input",50),e()()(),t(105,"div",36)(106,"button",37),d("click",function(){return a.settingsModalInstance==null?null:a.settingsModalInstance.hide()}),n(107,"Cancelar"),e(),t(108,"button",38),n(109,"Salvar configura\xE7\xF5es"),e()()()()()),r&2){let l;o(21),P("ngModel",a.filtro),o(),m("disabled",!a.filteredWords.length),o(13),m("ngForOf",a.filteredWords),o(),m("ngIf",!a.filteredWords.length),o(3),m("formGroup",a.wordForm),o(3),v(a.editingIndex===null?"Nova palavra":"Editar palavra"),o(7),m("ngIf",((l=a.wordForm.get("palavra"))==null?null:l.touched)&&((l=a.wordForm.get("palavra"))==null?null:l.invalid)),o(5),m("ngForOf",a.niveis),o(8),m("formGroup",a.settingsForm),o(19),m("ngValue",!0),o(2),m("ngValue",!1),o(6),m("ngValue",!0),o(2),m("ngValue",!1)}},dependencies:[F,x,M,q,k,V,L,W,T,D,I,O,G,A,j,N],styles:[".admin-container[_ngcontent-%COMP%]{width:100%;padding:18px 8px}.page-title[_ngcontent-%COMP%]{font-weight:600}.table-responsive[_ngcontent-%COMP%]{margin-top:12px}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:middle}.btn-group[_ngcontent-%COMP%]   label.btn[_ngcontent-%COMP%]{cursor:pointer}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#021e5a08}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{font-weight:600}"]})};export{J as CacaPalavrasConfigComponent};
