import{a as K,b as X}from"./chunk-O5GQYPGG.js";import{a as G}from"./chunk-Y33K7AZW.js";import{a as H}from"./chunk-JWPH47B2.js";import{d as R}from"./chunk-PTHPNUVQ.js";import"./chunk-5BLSFZMB.js";import{b as P,d as E,e as O,f as T,g as V,h as k,l as Q,m as Y,n as J,q as I,t as W}from"./chunk-5VMU7HGZ.js";import{$ as N,Ab as C,Ca as B,Db as u,Eb as g,Fa as z,Fb as f,Ga as d,Pa as b,T as c,U as p,Ua as w,Ya as v,a as F,db as _,eb as t,ec as j,fb as n,fc as S,gb as L,lc as y,mb as x,ob as h,qb as M,sb as D,tb as U,ub as q,zb as r}from"./chunk-D5XL275M.js";function ie(m,s){if(m&1&&(t(0,"div",13),r(1),n()),m&2){let i=M();d(),C(i.errorMessage)}}var A=class m{close=new N;save=new N;oldPwd="";newPwd="";confirmPwd="";errorMessage="";onEsc(){this.close.emit()}fecharAoClicarFora(s){s.target.classList.contains("overlay")&&this.close.emit()}confirmar(){if(this.errorMessage="",!this.oldPwd||!this.newPwd||!this.confirmPwd){this.errorMessage="Preencha todos os campos.";return}if(this.newPwd.length<4){this.errorMessage="A nova senha deve ter no m\xEDnimo 4 caracteres.";return}if(this.newPwd!==this.confirmPwd){this.errorMessage="A confirma\xE7\xE3o n\xE3o coincide com a nova senha.";return}this.save.emit(this.newPwd)}static \u0275fac=function(i){return new(i||m)};static \u0275cmp=w({type:m,selectors:[["app-modal-alterar-senha"]],hostBindings:function(i,e){i&1&&h("keydown.escape",function(){return e.onEsc()},z)},outputs:{close:"close",save:"save"},decls:23,vars:4,consts:[[1,"overlay",3,"click"],[1,"modal"],[3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["type","password","name","oldPwd","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","password","name","newPwd","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"mb-1"],["type","password","name","confirmPwd","required","",1,"form-control",3,"ngModelChange","ngModel"],["class","error",4,"ngIf"],[1,"d-flex","justify-content-end","gap-2","mt-3"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","submit",1,"btn","btn-primary"],[1,"error"]],template:function(i,e){i&1&&(t(0,"div",0),h("click",function(l){return e.fecharAoClicarFora(l)}),n(),t(1,"div",1)(2,"h3"),r(3,"Alterar senha"),n(),t(4,"form",2),h("ngSubmit",function(){return e.confirmar()}),t(5,"div",3)(6,"label",4),r(7,"Senha atual"),n(),t(8,"input",5),f("ngModelChange",function(l){return g(e.oldPwd,l)||(e.oldPwd=l),l}),n()(),t(9,"div",3)(10,"label",4),r(11,"Nova senha"),n(),t(12,"input",6),f("ngModelChange",function(l){return g(e.newPwd,l)||(e.newPwd=l),l}),n()(),t(13,"div",7)(14,"label",4),r(15,"Confirmar nova senha"),n(),t(16,"input",8),f("ngModelChange",function(l){return g(e.confirmPwd,l)||(e.confirmPwd=l),l}),n()(),v(17,ie,2,1,"div",9),t(18,"div",10)(19,"button",11),h("click",function(){return e.close.emit()}),r(20,"Cancelar"),n(),t(21,"button",12),r(22,"Salvar"),n()()()()),i&2&&(d(8),u("ngModel",e.oldPwd),d(4),u("ngModel",e.newPwd),d(4),u("ngModel",e.confirmPwd),d(),_("ngIf",e.errorMessage))},dependencies:[y,S,W,k,P,E,O,I,V,T],styles:['@charset "UTF-8";.overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000073;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);z-index:9997}.modal[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:92%;max-width:420px;background:#fff;border-radius:18px;padding:20px 22px 24px;z-index:9999;animation:_ngcontent-%COMP%_fadeUp .28s ease;display:flex;flex-direction:column;gap:16px}.modal[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 6px;font-size:1.2rem;font-weight:700}.error[_ngcontent-%COMP%]{color:#d9534f;font-size:.9rem;margin-top:-6px}@keyframes _ngcontent-%COMP%_fadeUp{0%{transform:translate(-50%,-46%);opacity:0}to{transform:translate(-50%,-50%);opacity:1}}']})};var re=["avatarInput"];function oe(m,s){if(m&1&&(t(0,"option",35),r(1),n()),m&2){let i=s.$implicit;_("value",i),d(),C(i)}}function ae(m,s){if(m&1&&(t(0,"option",35),r(1),n()),m&2){let i=s.$implicit;_("value",i),d(),C(i)}}function le(m,s){if(m&1){let i=x();t(0,"div",12)(1,"label",13),r(2,"Equipe"),n(),t(3,"select",36),f("ngModelChange",function(a){c(i);let l=M();return g(l.usuario.tribo,a)||(l.usuario.tribo=a),p(a)}),t(4,"option",21),r(5,"Selecione..."),n(),v(6,ae,2,2,"option",22),n()()}if(m&2){let i=M();d(3),u("ngModel",i.usuario.tribo),d(3),_("ngForOf",i.equipesCentral)}}function se(m,s){if(m&1&&(t(0,"div",37),r(1),n()),m&2){let i=M();d(),C(i.successMessage)}}function de(m,s){if(m&1&&(t(0,"div",38),r(1),n()),m&2){let i=M();d(),C(i.errorMessage)}}function me(m,s){if(m&1){let i=x();t(0,"app-modal-alterar-senha",39),h("close",function(){c(i);let a=M();return p(a.abrirSenha=!1)})("save",function(a){c(i);let l=M();return p(l.salvarSenha(a))}),n()}}var Z=class m{constructor(s,i,e,a,l){this.router=s;this.usuariosService=i;this.loginService=e;this.comunidadesService=a;this.tribosService=l}avatarInput;usuario={id:"",nome:"",comunidade:"",tribo:"",login:"",senha:"",avatar:"",maxCoin:0,dataNascimento:"",frase:"",hobbies:"",interesses:"",perfil:{id:"",nome:""}};avatarPreview=null;setores=[];equipesCentral=[];successMessage="";errorMessage="";abrirSenha=!1;ngOnInit(){this.comunidadesService.getComunidades().subscribe(s=>{this.setores=s.map(i=>i.nome)}),this.tribosService.getTribos().subscribe(s=>{this.equipesCentral=s.map(i=>i.nome)}),this.usuariosService.getUsuarioAtual().subscribe(s=>{s&&(this.usuario=F({},s),this.avatarPreview=this.usuario.avatar)})}onAvatarChange(s){let i=s.target.files[0];if(!i)return;let e=new FileReader;e.onload=()=>{this.avatarPreview=e.result,this.usuario.avatar=e.result},e.readAsDataURL(i)}voltar(){this.router.navigate(["/inicio"])}openAvatarDialog(){try{this.avatarInput?.nativeElement?.click()}catch{}}salvar(){try{this.loginService.saveUser(this.usuario),this.successMessage="Informa\xE7\xF5es atualizadas com sucesso!",this.errorMessage="",setTimeout(()=>this.successMessage="",3e3)}catch{this.successMessage="",this.errorMessage="Ocorreu um erro ao salvar. Tente novamente.",setTimeout(()=>this.errorMessage="",5e3)}}abrirAlterarSenha(){this.abrirSenha=!0}salvarSenha(s){this.usuario.senha=s,this.successMessage="Senha atualizada com sucesso!",this.abrirSenha=!1,setTimeout(()=>this.successMessage="",3e3)}static \u0275fac=function(i){return new(i||m)(b(R),b(G),b(H),b(K),b(X))};static \u0275cmp=w({type:m,selectors:[["app-meu-perfil"]],viewQuery:function(i,e){if(i&1&&D(re,5),i&2){let a;U(a=q())&&(e.avatarInput=a.first)}},decls:82,vars:15,consts:[["avatarInput",""],["novalidate","",1,"form-section",3,"ngSubmit"],[1,"section-block"],[1,"section-title"],[1,"d-flex","align-items-center","gap-3"],[1,"avatar-wrap"],["alt","Avatar",1,"avatar-preview",3,"src"],[1,"d-flex","flex-column","gap-2"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"text-muted"],["type","file","accept","image/*",1,"d-none",3,"change"],[1,"row","g-3"],[1,"col-12","col-md-6"],[1,"form-label"],["type","text","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","login","disabled","",1,"form-control",3,"ngModelChange","ngModel"],["type","date","name","birth",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-label","d-flex","justify-content-between"],[1,"text-primary","pointer",3,"click"],["type","password","value","********","disabled","",1,"form-control"],["name","sector",1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12"],["rows","2","name","frase",1,"form-control","textarea-large",3,"ngModelChange","ngModel"],["rows","3","name","hobbies",1,"form-control",3,"ngModelChange","ngModel"],["rows","3","name","interesses",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","perfil",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","gap-2","justify-content-end","mt-4"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"mt-3"],["class","alert alert-success small mb-0",4,"ngIf"],["class","alert alert-danger small mb-0",4,"ngIf"],[3,"close","save",4,"ngIf"],[3,"value"],["name","equipe",1,"form-select",3,"ngModelChange","ngModel"],[1,"alert","alert-success","small","mb-0"],[1,"alert","alert-danger","small","mb-0"],[3,"close","save"]],template:function(i,e){if(i&1){let a=x();t(0,"form",1),h("ngSubmit",function(){return c(a),p(e.salvar())}),t(1,"div",2)(2,"h2",3),r(3,"Foto de Perfil"),n(),t(4,"div",4)(5,"div",5),L(6,"img",6),n(),t(7,"div",7)(8,"button",8),h("click",function(){return c(a),p(e.openAvatarDialog())}),r(9," Trocar foto "),n(),t(10,"small",9),r(11," JPG ou PNG at\xE9 5 MB. "),n()(),t(12,"input",10,0),h("change",function(o){return c(a),p(e.onAvatarChange(o))}),n()()(),t(14,"div",2)(15,"h2",3),r(16,"Informa\xE7\xF5es B\xE1sicas"),n(),t(17,"div",11)(18,"div",12)(19,"label",13),r(20,"Nome completo"),n(),t(21,"input",14),f("ngModelChange",function(o){return c(a),g(e.usuario.nome,o)||(e.usuario.nome=o),p(o)}),n()(),t(22,"div",12)(23,"label",13),r(24,"Login"),n(),t(25,"input",15),f("ngModelChange",function(o){return c(a),g(e.usuario.login,o)||(e.usuario.login=o),p(o)}),n()(),t(26,"div",12)(27,"label",13),r(28,"Data de nascimento"),n(),t(29,"input",16),f("ngModelChange",function(o){return c(a),g(e.usuario.dataNascimento,o)||(e.usuario.dataNascimento=o),p(o)}),n()(),t(30,"div",12)(31,"label",17)(32,"span"),r(33,"Senha"),n(),t(34,"a",18),h("click",function(){return c(a),p(e.abrirAlterarSenha())}),r(35," Alterar senha "),n()(),L(36,"input",19),n()()(),t(37,"div",2)(38,"h2",3),r(39,"Organiza\xE7\xE3o"),n(),t(40,"div",11)(41,"div",12)(42,"label",13),r(43,"Setor"),n(),t(44,"select",20),f("ngModelChange",function(o){return c(a),g(e.usuario.comunidade,o)||(e.usuario.comunidade=o),p(o)}),t(45,"option",21),r(46,"Selecione..."),n(),v(47,oe,2,2,"option",22),n()(),v(48,le,7,2,"div",23),n()(),t(49,"div",2)(50,"h2",3),r(51,"Sobre voc\xEA"),n(),t(52,"div",11)(53,"div",24)(54,"label",13),r(55,"Frase pessoal"),n(),t(56,"textarea",25),f("ngModelChange",function(o){return c(a),g(e.usuario.frase,o)||(e.usuario.frase=o),p(o)}),n()(),t(57,"div",12)(58,"label",13),r(59,"Hobbies"),n(),t(60,"textarea",26),f("ngModelChange",function(o){return c(a),g(e.usuario.hobbies,o)||(e.usuario.hobbies=o),p(o)}),n()(),t(61,"div",12)(62,"label",13),r(63,"Interesses"),n(),t(64,"textarea",27),f("ngModelChange",function(o){return c(a),g(e.usuario.interesses,o)||(e.usuario.interesses=o),p(o)}),n()()()(),t(65,"div",2)(66,"h2",3),r(67,"Perfil Corporativo"),n(),t(68,"div",11)(69,"div",12)(70,"label",13),r(71,"Cargo / Perfil"),n(),t(72,"input",28),f("ngModelChange",function(o){return c(a),g(e.usuario.perfil.nome,o)||(e.usuario.perfil.nome=o),p(o)}),n()()()(),t(73,"div",29)(74,"button",8),h("click",function(){return c(a),p(e.voltar())}),r(75,"Cancelar"),n(),t(76,"button",30),r(77," Salvar altera\xE7\xF5es "),n()(),t(78,"div",31),v(79,se,2,1,"div",32)(80,de,2,1,"div",33),n()(),v(81,me,1,0,"app-modal-alterar-senha",34)}i&2&&(d(6),_("src",e.avatarPreview||e.usuario.avatar,B),d(15),u("ngModel",e.usuario.nome),d(4),u("ngModel",e.usuario.login),d(4),u("ngModel",e.usuario.dataNascimento),d(15),u("ngModel",e.usuario.comunidade),d(3),_("ngForOf",e.setores),d(),_("ngIf",e.usuario.comunidade==="Central de Atendimento"),d(8),u("ngModel",e.usuario.frase),d(4),u("ngModel",e.usuario.hobbies),d(4),u("ngModel",e.usuario.interesses),d(8),u("ngModel",e.usuario.perfil.nome),d(4),_("disabled",!(e.usuario!=null&&e.usuario.nome)),d(3),_("ngIf",e.successMessage),d(),_("ngIf",e.errorMessage),d(),_("ngIf",e.abrirSenha))},dependencies:[y,j,S,W,k,Y,J,P,Q,E,O,I,V,T,A],styles:[".perfil-container[_ngcontent-%COMP%]{max-width:980px;margin:28px auto;padding:20px;font-family:Segoe UI,system-ui,-apple-system,Helvetica Neue,Arial;color:#073042}.perfil-header[_ngcontent-%COMP%]{text-align:left;margin-bottom:12px}.perfil-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;color:#036;margin-bottom:.2rem}.perfil-header[_ngcontent-%COMP%]   .muted[_ngcontent-%COMP%]{color:#5f6b72;margin:0}.perfil-card[_ngcontent-%COMP%]{display:flex;gap:28px;background:#fff;padding:22px;border-radius:14px;box-shadow:0 8px 26px #0230560f;align-items:flex-start;flex-wrap:wrap}.avatar-section[_ngcontent-%COMP%]{width:260px;display:flex;flex-direction:column;align-items:center;gap:14px;position:relative}.avatar-wrap[_ngcontent-%COMP%]{position:relative;width:180px;height:180px;border-radius:50%;overflow:hidden;cursor:pointer;transition:transform .18s ease,box-shadow .18s ease;box-shadow:0 8px 20px #02305614}.avatar-wrap[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 14px 36px #0230561f}.avatar-preview[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;display:block}.avatar-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;color:#fff;background:linear-gradient(180deg,#0000,#00000059);opacity:0;transition:opacity .18s ease;font-weight:600;font-size:.95rem;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.avatar-wrap[_ngcontent-%COMP%]:hover   .avatar-overlay[_ngcontent-%COMP%], .avatar-wrap[_ngcontent-%COMP%]:focus   .avatar-overlay[_ngcontent-%COMP%]{opacity:1}.avatar-overlay[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem;background:#ffffff1f;padding:6px;border-radius:8px}.score-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;background:#f5fbff;border:1px solid rgba(0,119,200,.06);padding:8px 12px;border-radius:12px;color:#036;font-weight:600}.score-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#ffb400;font-size:1.15rem}.score-badge[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{font-size:.77rem;color:#5f6b72}.score-badge[_ngcontent-%COMP%]   .big[_ngcontent-%COMP%]{font-size:1.05rem;font-weight:800}.form-section[_ngcontent-%COMP%]{flex:1}.form-label[_ngcontent-%COMP%]{display:block;margin-bottom:6px;color:#173848;font-weight:600;font-size:.95rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border-radius:10px;border:1px solid #e6eef5;background:#fbfdff;padding:10px 12px;color:#073042;box-shadow:none;transition:box-shadow .12s ease,transform .12s ease}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 6px 18px #0373bf1f;transform:translateY(-1px)}.btn[_ngcontent-%COMP%]{border-radius:10px;padding:10px 14px;font-weight:700}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(180deg,#0077c8,#005fa3);border:none;color:#fff}.btn-outline-secondary[_ngcontent-%COMP%]{background:transparent;border:1px solid #d7dde3;color:#173848}.alert[_ngcontent-%COMP%]{border-radius:10px;padding:8px 12px}@media(max-width:768px){.perfil-card[_ngcontent-%COMP%]{padding:16px;gap:18px}.avatar-section[_ngcontent-%COMP%]{width:100%;flex-direction:row;justify-content:flex-start;gap:16px}.avatar-wrap[_ngcontent-%COMP%]{width:92px;height:92px}.form-section[_ngcontent-%COMP%]{width:100%}}.section-block[_ngcontent-%COMP%]{margin-bottom:28px;padding-bottom:22px;border-bottom:1px solid #eef3f7}.section-block[_ngcontent-%COMP%]:last-child{border-bottom:none}.section-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:#036;margin-bottom:14px}.textarea-large[_ngcontent-%COMP%]{min-height:80px}"]})};export{Z as MeuPerfilComponent};
