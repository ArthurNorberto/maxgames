<form class="form-section" (ngSubmit)="salvar()" novalidate>

  <!-- SEﾃﾃグ: Avatar -->
  <div class="section-block">
    <h2 class="section-title">Foto de Perfil</h2>

    <div class="d-flex align-items-center gap-3">

      <div class="avatar-wrap">
        <img class="avatar-preview" [src]="avatarPreview || usuario.avatar" alt="Avatar" />
      </div>

      <div class="d-flex flex-column gap-2">
        <button type="button" class="btn btn-outline-secondary" (click)="openAvatarDialog()">
          Trocar foto
        </button>

        <small class="text-muted">
          JPG ou PNG atﾃｩ 5 MB.
        </small>
      </div>

      <!-- 櫨 Input oculto para enviar arquivo -->
      <input #avatarInput type="file" accept="image/*" class="d-none" (change)="onAvatarChange($event)">
    </div>
  </div>


  <!-- SEﾃﾃグ: Informaﾃｧﾃｵes bﾃ｡sicas -->
  <div class="section-block">
    <h2 class="section-title">Informaﾃｧﾃｵes Bﾃ｡sicas</h2>

    <div class="row g-3">
      <div class="col-12 col-md-6">
        <label class="form-label">Nome completo</label>
        <input class="form-control" type="text" [(ngModel)]="usuario.nome" name="name" required />
      </div>

      <div class="col-12 col-md-6">
        <label class="form-label">Login</label>
        <input class="form-control" type="text" [(ngModel)]="usuario.login" name="login" disabled />
      </div>

      <div class="col-12 col-md-6">
        <label class="form-label">Data de nascimento</label>
        <input class="form-control" type="date" [(ngModel)]="usuario.dataNascimento" name="birth" />
      </div>

      <div class="col-12 col-md-6">
        <label class="form-label d-flex justify-content-between">
          <span>Senha</span>
          <a class="text-primary pointer" (click)="abrirAlterarSenha()">
            Alterar senha
          </a>
        </label>

        <!-- Campo sﾃｳ visual -->
        <input class="form-control" type="password" value="********" disabled>
      </div>
    </div>
  </div>

  <!-- SEﾃﾃグ: Organizaﾃｧﾃ｣o -->
  <div class="section-block">
    <h2 class="section-title">Organizaﾃｧﾃ｣o</h2>

    <div class="row g-3">
      <div class="col-12 col-md-6">
        <label class="form-label">Setor</label>
        <select class="form-select" [(ngModel)]="usuario.comunidade" name="sector">
          <option value="">Selecione...</option>
          <option *ngFor="let s of setores" [value]="s">{{ s }}</option>
        </select>
      </div>

      <div class="col-12 col-md-6" *ngIf="usuario.comunidade === 'Central de Atendimento'">
        <label class="form-label">Equipe</label>
        <select class="form-select" [(ngModel)]="usuario.tribo" name="equipe">
          <option value="">Selecione...</option>
          <option *ngFor="let e of equipesCentral" [value]="e">{{ e }}</option>
        </select>
      </div>
    </div>
  </div>

  <!-- SEﾃﾃグ: Sobre vocﾃｪ -->
  <div class="section-block">
    <h2 class="section-title">Sobre vocﾃｪ</h2>

    <div class="row g-3">
      <div class="col-12">
        <label class="form-label">Frase pessoal</label>
        <textarea class="form-control textarea-large" rows="2" [(ngModel)]="usuario.frase" name="frase"></textarea>
      </div>

      <div class="col-12 col-md-6">
        <label class="form-label">Hobbies</label>
        <textarea class="form-control" rows="3" [(ngModel)]="usuario.hobbies" name="hobbies"></textarea>
      </div>

      <div class="col-12 col-md-6">
        <label class="form-label">Interesses</label>
        <textarea class="form-control" rows="3" [(ngModel)]="usuario.interesses" name="interesses"></textarea>
      </div>
    </div>
  </div>

  <!-- SEﾃﾃグ: Perfil -->
  <div class="section-block">
    <h2 class="section-title">Perfil Corporativo</h2>

    <div class="row g-3">
      <div class="col-12 col-md-6">
        <label class="form-label">Cargo / Perfil</label>
        <input class="form-control" type="text" [(ngModel)]="usuario.perfil.nome" name="perfil" />
      </div>
    </div>
  </div>

  <!-- Botﾃｵes -->
  <div class="d-flex gap-2 justify-content-end mt-4">
    <button type="button" class="btn btn-outline-secondary" (click)="voltar()">Cancelar</button>
    <button type="submit" class="btn btn-primary" [disabled]="!usuario?.nome">
      Salvar alteraﾃｧﾃｵes
    </button>
  </div>

  <!-- mensagens -->
  <div class="mt-3">
    <div *ngIf="successMessage" class="alert alert-success small mb-0">{{ successMessage }}</div>
    <div *ngIf="errorMessage" class="alert alert-danger small mb-0">{{ errorMessage }}</div>
  </div>

</form>

<!-- MODAL ALTERAR SENHA -->
<app-modal-alterar-senha *ngIf="abrirSenha" (close)="abrirSenha = false" (save)="salvarSenha($event)">
</app-modal-alterar-senha>