<div class="wordsearch-wrapper container py-5">

  <div class="card shadow-lg border-0 game-card animate__animated animate__fadeIn">
    <div class="card-body p-4">

      <!-- HEADER -->
      <div class="text-center mb-4">
        <h2 class="mb-1">ğŸ” CaÃ§a-Palavras Autoglass</h2>
        <p class="text-muted small">Escolha o nÃ­vel e encontre as palavras do mundo automotivo!</p>
      </div>

      <!-- ABAS -->
      <ul class="nav nav-tabs custom-tabs mb-4 justify-content-center">
        <li class="nav-item">
          <button
            class="nav-link"
            [class.active]="activeTab === 'jogo'"
            (click)="activeTab = 'jogo'">
            ğŸ® Jogo
          </button>
        </li>

        <li class="nav-item">
          <button
            class="nav-link"
            [class.active]="activeTab === 'rank'"
            (click)="activeTab = 'rank'">
            ğŸ† Ranking
          </button>
        </li>
      </ul>

      <!-- ==================== JOGO ==================== -->
      <div *ngIf="activeTab === 'jogo'" class="animate__animated animate__fadeIn">

        <!-- SeleÃ§Ã£o de dificuldade -->
        <div class="difficulty-select text-center mb-4">
          <button class="btn diff-btn easy"
                  [class.active]="difficulty === 'facil'"
                  (click)="setDifficulty('facil')">ğŸ˜Š FÃ¡cil (5)</button>

          <button class="btn diff-btn medium"
                  [class.active]="difficulty === 'medio'"
                  (click)="setDifficulty('medio')">ğŸ˜ MÃ©dio (8)</button>

          <button class="btn diff-btn hard"
                  [class.active]="difficulty === 'dificil'"
                  (click)="setDifficulty('dificil')">ğŸ˜ˆ DifÃ­cil (10)</button>
        </div>

        <!-- LOADING -->
        <div *ngIf="loading" class="loading-overlay text-center py-5">
          <div class="spinner-border text-primary mb-3" role="status"></div>
          <p class="text-muted">Gerando jogo...</p>
        </div>

        <!-- Ãrea do jogo -->
        <div *ngIf="!loading" class="animate__animated animate__fadeIn">

          <div class="d-flex justify-content-between align-items-center mb-3 px-3">
            <span>â±ï¸ Tempo: <strong>{{ timer }}s</strong></span>
            <span>â­ Pontos: <strong>{{ score }}</strong></span>
          </div>

          <!-- GRID -->
          <div class="game-area position-relative mb-4">
            <div class="grid"
                 [ngStyle]="{'grid-template-columns': 'repeat(' + cols + ', 1fr)'}">

              <div
                *ngFor="let cell of grid; let idx = index; trackBy: trackByIndex"
                class="cell"
                [attr.data-letter]="cell.letter"
                [class.selected]="selectedCells.includes(idx)"
                [class.found]="cell.isFound"
                (mousedown)="cellMouseDown(idx)"
                (mouseenter)="cellMouseEnter(idx)"
                (mouseup)="cellMouseUp()">
              </div>

            </div>
          </div>

          <!-- LISTA DE PALAVRAS -->
          <div class="word-list text-center mb-4">
            <h5>Palavras para encontrar:</h5>
            <ul>
              <li *ngFor="let w of words" [class.found]="foundWords.includes(w)">
                {{ w }}
              </li>
            </ul>
          </div>

          <!-- FIM DE JOGO -->
          <div *ngIf="gameOver"
               class="end-screen text-center animate__animated animate__zoomIn">
            <h4>{{ endMessage }}</h4>
            <button class="btn btn-primary mt-3" (click)="newGame()">
              ğŸ” Nova Partida
            </button>
          </div>

        </div>
      </div>

      <!-- ==================== RANK ==================== -->
      <div *ngIf="activeTab === 'rank'" class="rank-pane animate__animated animate__fadeIn">

        <div class="panel-stats p-4 bg-light rounded mx-auto" style="max-width: 500px;">
          <h5 class="mb-3 text-center">ğŸ† Ranking â€“ Quem encontrou mais palavras</h5>

          <ol class="rank-list">
            <li *ngFor="let r of ranking">
              {{ r.name }} â€” <strong>{{ r.score }} pts</strong>
            </li>
          </ol>

        </div>

      </div>

    </div>
  </div>

</div>
